{
    "contents" : "# 第5章 データ解析の基礎\n\n\n##5.3 データの要約\n###5.3.1 棒グラフ\nY <- rep (\"Y\", 180)  # Y を 180 個生成\nN <- rep (\"N\", 120)  # N を 120 個生成\t\t\nY  # Y だけ確認\n\nYN <- c (Y, N)       # Y と N を結合\ntable (YN)           # 頻度を確認\n## YN\n##   N   Y \n## 120 180 \nbarplot(table(YN))  # 棒グラフにしてみる\n\n\n###5.3.2 ヒストグラム\n\n178.59,181.14,177.6,180.55,178.54,179.32,\n180.01,179.44,180.65,181.55,179.2,180.56,\n179.9,178.81,179.64,179.63,179.36,178.85,\n179.82,182.43,180.47,179.66,181.54,178.98,\n180.2,179.87,179.05,179.72,179.34,180.26\n\nx <- c (178.59,181.14,177.6,180.55,178.54,179.32,\n       180.01,179.44,180.65,181.55,179.2,180.56,\n       179.9,178.81,179.64,179.63,179.36,178.85,\n       179.82,182.43,180.47,179.66,181.54,178.98,\n       180.2,179.87,179.05,179.72,179.34,180.26)\nhist(x)\ndev.off ()\n\n###5.3.3 中央値，平均値，最頻値\nmedian(x)\n\nmean (x)\n\n x [1]\n# [1] 178.59\n x [30]\n#[1] 180.26\n sum (x)          # 合計\n# [1] 5394.68   \n length (x)       # データ数\n# [1] 30\nsum (x) / length (x)  # 平均値を算出\n\nz <- hist(x)\nz\n\n###5.3.4 分散\n\nnew.x <- c (183.08,179.6,176.87,180.87,179.95,177.27,\n       181.62,176.83,179.45,181.3,175.5,178.22,178.41,\n       185.49,180.11,180.11,178.12,180.61,177.25,182.68,\n       179.37,180.44,179.61,180.37,176.93,180.82,180.04,\n       180.4,181.75,174.56)\nmean(new.x)\n\n\n\nboxplot(x, new.x, names = c (\"x\",\"x.new\") )\ndev.off ()\n\nsum((x - mean(x))^2 ) / length(x)\n\nvar (x)\nsum((x - mean(x))^2 ) / (length(x) - 1)\n\nz <- c (40, 50, 60, 70, 80)\nmean (z)\n\nsd (x)\n\n\n##5.4 データの分布\nx <- c (178.59,181.14,177.6,180.55,178.54,179.32,\n          180.01,179.44,180.65,181.55,179.2,180.56,\n          179.9,178.81,179.64,179.63,179.36,178.85,\n          179.82,182.43,180.47,179.66,181.54,178.98,\n          180.2,179.87,179.05,179.72,179.34,180.26)\n\n\npar(mfrow = c(2,1))\ny <- hist(x)\nboxplot(x)\ndev.off ()\n\ny\n\n###### コラム：水準ごとの平均\nsummary (iris)\n\nmean (iris [, -5])\n\ncolMeans (iris [, -5])\n#sapply (iris [, -5],  mean)\n\naggregate (iris [, -5],  iris[5], mean)\n\nhead (CO2)\n\ntapply (CO2$uptake,  CO2 [c (\"Type\", \"Treatment\")],  mean)\n#####\n\n\n##5.5 確率分布とは\n###5.5.1 Rによるシミュレーション\n\n(x <- c(\"表\",\"裏\"))\nz <- numeric (100)\nset.seed (123)\nfor (i in 1:100){\n  y <- sample (x, 10, rep = TRUE)\n  z[i] <- sum (y == \"表\")\n}\ntable (z)\n\n\nhist (z, breaks = 0:10)\ndev.off ()\n## set.seed (123)\n## z <- sample (x, 10, rep = TRUE)\n\n\nlibrary (animation)\nexample (flip.coin)\n\n###5.5.2  二項分布 \nchoose(10, 3)\nchoose (10, 3) * 0.5^3 * (1-0.5)^7\ndbinom(3, 10, 0.5)\n\n\n##5.6 確率とデータの関係\n\ncoin10 <- dbinom (0:10, 10, 0.5)\nplot (0:10, coin10, type = \"h\", lwd = 5)\n\ndev.off ()\n\n##5.7 確率密度について\n\nx <- c (178.59,181.14,177.6,180.55,178.54,179.32,\n       180.01,179.44,180.65,181.55,179.2,180.56,\n       179.9,178.81,179.64,179.63,179.36,178.85,\n       179.82,182.43,180.47,179.66,181.54,178.98,\n       180.2,179.87,179.05,179.72,179.34,180.26)\nhist(x)\n\n###5.7.2 正規分布について\n\ndnorm(181, mean = 180, sd = 1)\npnorm(181, mean = 180, sd = 1)\npnorm (181, mean = 180, sd = 1) - pnorm (180, mean = 180, sd = 1)\nqnorm (0.8413447, mean = 180, sd = 1)\n\n\n##5.8 平均値の推定\n\nx <- c (178.59,181.14,177.6,180.55,178.54,179.32,\n         180.01,179.44,180.65,181.55,179.2,180.56,\n         179.9,178.81,179.64,179.63,179.36,178.85,\n         179.82,182.43,180.47,179.66,181.54,178.98,\n         180.2,179.87,179.05,179.72,179.34,180.26)\nmean (x)\n## [1] 179.8227\nsd (x)\n\n\n##### コラム： 母集団と標本\n10 - 2 * sqrt ( (10 * (100- 90) ) / 6600)  \n##[1] 9.753817\n10 + 2 * sqrt ( (10 * (100- 90))  / 6600) \n\n\n###5.8.1 平均値の性質\n\n1 / sqrt(30)\nc (179.8227 - 0.1825742 * 1.96, 179.8227 + 0.1825742 * 1.96)\n\nexample(clt.ani)\n\n##### コラム：t 分布のプロット\n curve (dt(x, 20),-4,4, type=\"l\", lwd = 3, col=1,\n\t\t main = \"t 分布はデータ数 N で変化する\", ylab = \"確率\")\n text (1, .4, \"N = 20 の場合\")\n curve (dt(x, 10),-4,4,type=\"l\", lwd = 3, col=2, add=T)\n text (1.5, .35, \"N = 10 の場合\", col=2)\n curve (dt(x, 8),-4,4,type=\"l\",lwd = 3,col=3, add=T)\n text (1.8, .3, \"N = 8 の場合\", col=3)\n curve (dt(x, 2),-4,4,type=\"l\",lwd = 3,col=4, add=T)\n text (2.8, .17, \"N =2 の場合\", col=4)\n # dnorm()関数で正規分布を重ねます\n curve (dnorm(x), type=\"l\", lty=2, lwd = 3, col=6, add=T)\ntext (-3, .2, \"正規分布\", col=6)\n legend (-4, .4, legend = c(\"N=20\",\"N=10\",\"N=5\",\"N=2\", \"正規分布\"),\n          col = c(1:4,6) , lwd = 3, lty = c(1,1,1,1,2))\n text (0, .03, \"中央面積が0.95となる場合の\")\n text (0, .01, \"両端のx軸の値を知りたい\")\n\n###5.8.3 母集団の標準偏差が未知の場合\nN <- 30\nqt (0.975, N - 1 ) # Excel なら tinv(0.05, N-1)\nN <- 10\nqt (0.975, N - 1 ) \n##[1] 2.262157\nc (156 - 2.262 * 14/sqrt(10), 156 + 2.262 * 14/sqrt(10))\n## [1] 145.9857 166.0143\n\n\n###5.8.4 比率の区間推定\nc (0.08 - 1.96 * sqrt (0.08 * (1 - 0.08) / 300),\n     0.08 + 1.96 * sqrt (0.08 * (1 - 0.08) / 300)) \n",
    "created" : 1362835914244.000,
    "dirty" : false,
    "encoding" : "SHIFT-JIS",
    "folds" : "",
    "hash" : "1592156253",
    "id" : "39060990",
    "lastKnownWriteTime" : 1347337808,
    "path" : "C:/Users/y-yoshimura/Desktop/1327/windows/script/Chapter05.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}